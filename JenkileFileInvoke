pipeline{
agent any
       stages {
		stage ("Invoke Pipeline")
		  {
		steps {
		    echo "Invoke Pipeline"
		    build job: 'getBuildNumber', parameters: [string(name: 'variable1', value: "from Pipeline")  ]
		    }
		   


 post            {
		    	always {
			script {
		  def lastBuild = Jenkins.instance.getItem('getBuildNumber').lastBuild.number

		  def lastSuccessfulBuild = Jenkins.instance.getItem('getBuildNumber').lastSuccessfulBuild.number
		echo lastBuild
		echo lastSuccessfulBuild
		if ( lastBuild != lastSuccessfulBuild) {
			echo "Smoke Test Failed"
			return
		}
		else {
		script{
		echo "next"
		}
			}
		  }
	}
	
/*

		stage ("check")
		{
		  def lastBuild = Jenkins.instance.getItem('getBuildNumber').lastBuild.number

		  def lastSuccessfulBuild = Jenkins.instance.getItem('getBuildNumber').lastSuccessfulBuild.number
		echo lastBuild
		echo lastSuccessfulBuild
		if ( lastBuild != lastSuccessfulBuild) {
			echo "Smoke Test Failed"
			return

		}
		}
		
		*/
		stage ("Invoke Pipeline nxt")
		  {
		  steps {
		    echo "Running Next Stage"
			}
		  }
		  }
}
